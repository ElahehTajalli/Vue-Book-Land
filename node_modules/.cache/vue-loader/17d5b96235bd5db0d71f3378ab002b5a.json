{"remainingRequest":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/elaheh/Documents/University/Vue-Book-Land/src/components/chat/Messages.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/elaheh/Documents/University/Vue-Book-Land/src/components/chat/Messages.vue","mtime":1630222369391},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjaGF0czogW10sCiAgICAgIHVzZXI6IHt9LAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgbWVzc2FnZTogJycsCiAgICAgIHRpbWVyOiAwCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKHRoaXMuZ2V0RGF0YSwgMTAwMCkKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsnc2VsZiddKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwQWN0aW9ucyhbJ2hhbmRsZVJlcXVlc3QnXSksCiAgICBnZXREYXRhKCkgewogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdjaGF0cycsCiAgICAgICAgYWN0aW9uOiAnZ2V0T25lJywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBpZDogdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICAgICAgfQogICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuY2hhdHMgPSByZXMuZGF0YS5tZXNzYWdlcwogICAgICAgICAgdGhpcy51c2VyID0gcmVzLmRhdGEudXNlcgogICAgICAgIH0pCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB9KQogICAgfSwKICAgIHNlbmRNZXNzYWdlKCkgewogICAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3JlY2VpdmVyJywgdGhpcy4kcm91dGUucGFyYW1zLmlkKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RleHQnLCB0aGlzLm1lc3NhZ2UpCgogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdjaGF0cy8nLAogICAgICAgIGFjdGlvbjogJ2NyZWF0ZScsCiAgICAgICAgZGF0YTogZm9ybURhdGEKICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5jaGF0cy5wdXNoKHJlcykKICAgICAgICB0aGlzLm1lc3NhZ2UgPSAnJwogICAgICB9KQogICAgfSwKICAgIHJvdXRlVG8oKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnVmlld1VzZXInLAogICAgICAgIHBhcmFtczogeyBpZDogdGhpcy4kcm91dGUucGFyYW1zLmlkIH0KICAgICAgfSkKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpCiAgfQp9Cg=="},{"version":3,"sources":["Messages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Messages.vue","sourceRoot":"src/components/chat","sourcesContent":["<template>\n  <div class=\"messages\" v-loading.fullscreen.lock=\"loading\">\n    <el-card>\n      <div slot=\"header\" class=\"clearfix\">\n        <div>\n          <img\n            class=\"user-picture\"\n            v-if=\"user.image\"\n            :src=\"'http://ketabland.pythonanywhere.com' + user.image\"\n          />\n          <img\n            v-else\n            class=\"user-picture\"\n            src=\"https://img.icons8.com/cotton/64/000000/person-male--v2.png\"\n          />\n          <span class=\"bold-title\">{{ user.persian_username }}</span>\n        </div>\n        <el-button type=\"primary\" @click=\"routeTo()\">\n          {{ $t('show_profile') }}\n        </el-button>\n      </div>\n      <div class=\"main\">\n        <div class=\"chats\">\n          <span\n            v-for=\"c in chats\"\n            :key=\"c.id\"\n            :class=\"c.receiver.id === self.id ? 'receiver' : 'sender'\"\n          >\n            {{ c.text }}\n          </span>\n        </div>\n      </div>\n    </el-card>\n    <div class=\"bottom\">\n      <el-input v-model=\"message\" />\n      <el-button type=\"primary\" @click=\"sendMessage()\">\n        {{ $t('send') }}\n      </el-button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapGetters, mapActions } from 'vuex'\n\n  export default {\n    data() {\n      return {\n        chats: [],\n        user: {},\n        loading: false,\n        message: '',\n        timer: 0\n      }\n    },\n    created() {\n      this.loading = true\n      this.timer = setInterval(this.getData, 1000)\n    },\n    computed: {\n      ...mapGetters(['self'])\n    },\n    methods: {\n      ...mapActions(['handleRequest']),\n      getData() {\n        this.handleRequest({\n          name: 'chats',\n          action: 'getOne',\n          data: {\n            id: this.$route.params.id\n          }\n        })\n          .then((res) => {\n            this.chats = res.data.messages\n            this.user = res.data.user\n          })\n          .finally(() => {\n            this.loading = false\n          })\n      },\n      sendMessage() {\n        let formData = new FormData()\n        formData.append('receiver', this.$route.params.id)\n        formData.append('text', this.message)\n\n        this.handleRequest({\n          name: 'chats/',\n          action: 'create',\n          data: formData\n        }).then((res) => {\n          this.chats.push(res)\n          this.message = ''\n        })\n      },\n      routeTo() {\n        this.$router.push({\n          name: 'ViewUser',\n          params: { id: this.$route.params.id }\n        })\n      }\n    },\n    beforeDestroy() {\n      clearInterval(this.timer)\n    }\n  }\n</script>\n"]}]}