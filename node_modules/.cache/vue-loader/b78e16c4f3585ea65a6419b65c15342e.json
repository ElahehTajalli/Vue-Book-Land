{"remainingRequest":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/elaheh/Documents/University/Vue-Book-Land/src/components/post/View.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/elaheh/Documents/University/Vue-Book-Land/src/components/post/View.vue","mtime":1630222369431},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEFjdGlvbnMsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JwppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudC1qYWxhYWxpJwppbXBvcnQgQ29tbWVudCBmcm9tICdAL2NvbXBvbmVudHMvY29tbWVudC9Db21tZW50JwovLyBpbXBvcnQgQ3JpdGljaXNtIGZyb20gJ0AvY29tcG9uZW50cy9wb3N0L0NyaXRpY2lzbScKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBib29rOiB7fSwKICAgICAgcG9zdDoge30sCiAgICAgIGNvbW1lbnRzOiBbXSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHN1Ym1pdExvYWRpbmc6IGZhbHNlLAogICAgICBqYWxhbGlGb3JtYXQ6ICdqWVlZWS9qTS9qRCcsCiAgICAgIG5ld19wb3N0OiAnJywKICAgICAgZm9ybTogewogICAgICAgIGNvbW1lbnRfdGV4dDogJycKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBjb21tZW50X3RleHQ6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJGkxOG4udCgnZmllbGRfcmVxdWlyZWQnKSwKICAgICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9CiAgICB9CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgYXdhaXQgdGhpcy5nZXRQb3N0KCkKICAgIGF3YWl0IHRoaXMuZ2V0Q29tbWVudHMoKQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoWydzZWxmJ10pLAogICAgZGF0ZVRpbWUoKSB7CiAgICAgIHJldHVybiBtb21lbnQodGhpcy5wb3N0LmNyZWF0ZWRfYXQpLmZvcm1hdCh0aGlzLmphbGFsaUZvcm1hdCkKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoWydoYW5kbGVSZXF1ZXN0J10pLAogICAgZ2V0UG9zdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdwb3N0cycsCiAgICAgICAgYWN0aW9uOiAnZ2V0T25lJywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBpZDogdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICAgICAgfQogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLnBvc3QgPSByZXMuZGF0YS5wb3N0CiAgICAgICAgdGhpcy5uZXdfcG9zdCA9IHRoaXMucG9zdAogICAgICAgIHRoaXMuYm9vayA9IHJlcy5kYXRhLnBvc3QuYm9vawogICAgICB9KQogICAgfSwKICAgIGdldENvbW1lbnRzKCkgewogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdjb21tZW50cy8nLAogICAgICAgIGFjdGlvbjogJ2dldEFsbCcsCiAgICAgICAgZGF0YTogewogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgcG9zdF9pZDogdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuY29tbWVudHMgPSByZXMuZGF0YS5jb21tZW50cwogICAgICAgIH0pCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB9KQogICAgfSwKICAgIGVkaXRQb3N0KGFjdGlvbikgewogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdwb3N0cy9lZGl0JywKICAgICAgICBhY3Rpb246ICdwYXRjaCcsCiAgICAgICAgZGF0YTogewogICAgICAgICAgdG9QYXRjaDogewogICAgICAgICAgICB1c2VyOiB0aGlzLnNlbGYuaWQsCiAgICAgICAgICAgIHBvc3Q6ICt0aGlzLiRyb3V0ZS5wYXJhbXMuaWQsCiAgICAgICAgICAgIGFjdGlvbgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5uZXdfcG9zdCA9IHJlcy5kYXRhLnBvc3QKICAgICAgfSkKICAgIH0sCiAgICBhZGRDb21tZW50KCkgewogICAgICB0aGlzLnN1Ym1pdExvYWRpbmcgPSB0cnVlCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcl9pZCcsIHRoaXMuc2VsZi5pZCkKICAgICAgZm9ybURhdGEuYXBwZW5kKCdwb3N0X2lkJywgdGhpcy4kcm91dGUucGFyYW1zLmlkKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RleHQnLCB0aGlzLmZvcm0uY29tbWVudF90ZXh0KQoKICAgICAgdGhpcy5oYW5kbGVSZXF1ZXN0KHsKICAgICAgICBuYW1lOiAnY29tbWVudHMvJywKICAgICAgICBhY3Rpb246ICdjcmVhdGUnLAogICAgICAgIGRhdGE6IGZvcm1EYXRhCiAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kaTE4bi50KCd0aGVfY29tbWVudF93YXNfc3VjY2Vzc2Z1bGx5X2FkZGVkJykKICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLmdldENvbW1lbnRzKCkKICAgICAgICAgIHRoaXMuZm9ybS5jb21tZW50X3RleHQgPSAnJwogICAgICAgICAgdGhpcy5zdWJtaXRMb2FkaW5nID0gZmFsc2UKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnN1Ym1pdExvYWRpbmcgPSBmYWxzZQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJGkxOG4udCgKICAgICAgICAgICAgICAneW91cl9yZXF1ZXN0X2hhc19lbmNvdW50ZXJlZF9hX3Byb2JsZW1fcGxlYXNlX3RyeV9hZ2FpbicKICAgICAgICAgICAgKQogICAgICAgICAgfSkKICAgICAgICB9KQogICAgfSwKICAgIHNob3dVc2VyKGlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogJ1ZpZXdVc2VyJywgcGFyYW1zOiB7IGlkIH0gfSkKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIENvbW1lbnQKICAgIC8vIENyaXRpY2lzbQogIH0KfQo="},{"version":3,"sources":["View.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"View.vue","sourceRoot":"src/components/post","sourcesContent":["<template>\n  <div class=\"view-post\" v-loading.fullscreen.lock=\"loading\">\n    <el-card v-if=\"!loading\" class=\"book-info\">\n      <div>\n        <img\n          v-if=\"book.image\"\n          :src=\"'http://ketabland.pythonanywhere.com' + book.image\"\n        />\n        <img v-else src=\"../../assets/images/noBook.png\" />\n      </div>\n      <div class=\"book-information\">\n        <div>\n          <span class=\"name\"> {{ book.name }} </span>\n          <span v-if=\"book.author\">\n            {{ $t('book.author') }}: {{ book.author.name }}\n          </span>\n          <span v-if=\"book.translator\">\n            {{ $t('book.translator') }}: {{ book.translator.name }}\n          </span>\n          <span> {{ $t('book.publisher') }}: {{ book.publisher }} </span>\n          <span> {{ $t('book.genre') }}: {{ book.genre }} </span>\n          <span>\n            {{ $t('book.publication_year') }}: {{ book.publication_year }}\n          </span>\n        </div>\n      </div>\n    </el-card>\n    <!-- <div class=\"post-summary\">\n      <el-card v-if=\"book.summary\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{ $t('book.summary') }}</span>\n        </div>\n        <span class=\"summary\"> {{ book.summary }} </span>\n      </el-card>\n      <el-card class=\"post\" v-if=\"posts.length\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{ $t('criticisms') }}</span>\n        </div>\n        <Criticism v-for=\"p in posts\" :key=\"p.id\" :post=\"p\" />\n      </el-card>\n    </div> -->\n    <div\n      class=\"full-width flexbox column-direction align-center\"\n      style=\"flex: 1 1 0%;\"\n    >\n      <el-card class=\"post\" v-if=\"!loading && post\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{ $t('criticism') }}</span>\n        </div>\n        <div class=\"criticism\">\n          <div class=\"top\">\n            <div class=\"detail\">\n              <img\n                class=\"image\"\n                src=\"https://img.icons8.com/cotton/64/000000/person-male--v2.png\"\n              />\n              <span v-if=\"post.critic\" @click=\"showUser(post.critic.id)\">\n                {{ post.critic.persian_username }}\n              </span>\n            </div>\n          </div>\n          <span class=\"text\">{{ post.text }}</span>\n          <div class=\"bottom\">\n            <div class=\"date\">\n              <img src=\"https://img.icons8.com/ios/100/184277/planner.png\" />\n              <span>{{ dateTime }}</span>\n            </div>\n            <div class=\"likes\">\n              <div @click=\"editPost('dislike')\" v-if=\"post.dislikes\">\n                <span> {{ new_post.dislikes.length }} </span>\n                <img\n                  src=\"https://img.icons8.com/material-rounded/24/ff0000/thumbs-down.png\"\n                />\n              </div>\n              <div @click=\"editPost('like')\" v-if=\"post.likes\">\n                <span> {{ new_post.likes.length }} </span>\n                <img\n                  src=\"https://img.icons8.com/material-rounded/24/00ff30/facebook-like--v1.png\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </el-card>\n      <div class=\"comments-div\" v-if=\"!loading\">\n        <el-card v-if=\"comments.length\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>{{ $t('comments') }}</span>\n          </div>\n          <Comment v-for=\"cm in comments\" :key=\"cm.id\" :comment=\"cm\" />\n        </el-card>\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span>{{ $t('add_comment') }}</span>\n          </div>\n          <el-form :model=\"form\" ref=\"form\" :rules=\"rules\">\n            <el-form-item :label=\"$t('text')\" prop=\"comment_text\">\n              <el-input\n                type=\"textarea\"\n                class=\"rtl\"\n                resize=\"none\"\n                v-model=\"form.comment_text\"\n              ></el-input>\n            </el-form-item>\n            <el-button\n              :loading=\"submitLoading\"\n              type=\"primary\"\n              @click=\"validateAndSubmitForm('form', addComment)\"\n            >\n              {{ $t('submit') }}\n            </el-button>\n          </el-form>\n        </el-card>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapActions, mapGetters } from 'vuex'\n  import moment from 'moment-jalaali'\n  import Comment from '@/components/comment/Comment'\n  // import Criticism from '@/components/post/Criticism'\n  export default {\n    data() {\n      return {\n        book: {},\n        post: {},\n        comments: [],\n        loading: false,\n        submitLoading: false,\n        jalaliFormat: 'jYYYY/jM/jD',\n        new_post: '',\n        form: {\n          comment_text: ''\n        },\n        rules: {\n          comment_text: [\n            {\n              required: true,\n              message: this.$i18n.t('field_required'),\n              trigger: 'blur'\n            }\n          ]\n        }\n      }\n    },\n    async created() {\n      await this.getPost()\n      await this.getComments()\n    },\n    computed: {\n      ...mapGetters(['self']),\n      dateTime() {\n        return moment(this.post.created_at).format(this.jalaliFormat)\n      }\n    },\n    methods: {\n      ...mapActions(['handleRequest']),\n      getPost() {\n        this.loading = true\n        this.handleRequest({\n          name: 'posts',\n          action: 'getOne',\n          data: {\n            id: this.$route.params.id\n          }\n        }).then((res) => {\n          this.post = res.data.post\n          this.new_post = this.post\n          this.book = res.data.post.book\n        })\n      },\n      getComments() {\n        this.handleRequest({\n          name: 'comments/',\n          action: 'getAll',\n          data: {\n            query: {\n              post_id: this.$route.params.id\n            }\n          }\n        })\n          .then((res) => {\n            this.comments = res.data.comments\n          })\n          .finally(() => {\n            this.loading = false\n          })\n      },\n      editPost(action) {\n        this.handleRequest({\n          name: 'posts/edit',\n          action: 'patch',\n          data: {\n            toPatch: {\n              user: this.self.id,\n              post: +this.$route.params.id,\n              action\n            }\n          }\n        }).then((res) => {\n          this.new_post = res.data.post\n        })\n      },\n      addComment() {\n        this.submitLoading = true\n        let formData = new FormData()\n        formData.append('user_id', this.self.id)\n        formData.append('post_id', this.$route.params.id)\n        formData.append('text', this.form.comment_text)\n\n        this.handleRequest({\n          name: 'comments/',\n          action: 'create',\n          data: formData\n        })\n          .then(() => {\n            this.$message({\n              type: 'success',\n              message: this.$i18n.t('the_comment_was_successfully_added')\n            })\n            this.getComments()\n            this.form.comment_text = ''\n            this.submitLoading = false\n          })\n          .catch(() => {\n            this.submitLoading = false\n            this.$message({\n              type: 'error',\n              message: this.$i18n.t(\n                'your_request_has_encountered_a_problem_please_try_again'\n              )\n            })\n          })\n      },\n      showUser(id) {\n        this.$router.push({ name: 'ViewUser', params: { id } })\n      }\n    },\n    components: {\n      Comment\n      // Criticism\n    }\n  }\n</script>\n"]}]}