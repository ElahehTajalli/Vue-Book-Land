{"remainingRequest":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/elaheh/Documents/University/Vue-Book-Land/src/components/post/Add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/elaheh/Documents/University/Vue-Book-Land/src/components/post/Add.vue","mtime":1626857988609},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBZGRCb29rIGZyb20gJ0AvY29tcG9uZW50cy9ib29rL0FkZCcKaW1wb3J0IHsgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnCgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGRpYWxvZ1Zpc2libGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBib29rczogW10sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBib29rRGlhbG9nOiBmYWxzZSwKICAgICAgYWRkUG9zdEZvcm06IHsKICAgICAgICB0ZXh0OiAnJywKICAgICAgICByYXRlOiAwLAogICAgICAgIGJvb2s6ICcnCiAgICAgIH0sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgcmF0ZTogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kaTE4bi50KCdmaWVsZF9yZXF1aXJlZCcpLAogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIGJvb2s6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJGkxOG4udCgnZmllbGRfcmVxdWlyZWQnKQogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgdGV4dDogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kaTE4bi50KCdmaWVsZF9yZXF1aXJlZCcpLAogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmhhbmRsZUdldEJvb2tzKCkKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsnc2VsZiddKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwQWN0aW9ucyhbJ2hhbmRsZVJlcXVlc3QnXSksCiAgICBhZGRQb3N0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmFkZFBvc3RGb3JtKSkgewogICAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIHZhbHVlKQogICAgICB9CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcicsIHRoaXMuc2VsZi5pZCkKCiAgICAgIHRoaXMuaGFuZGxlUmVxdWVzdCh7CiAgICAgICAgbmFtZTogJ3Bvc3RzLycsCiAgICAgICAgYWN0aW9uOiAnY3JlYXRlJywKICAgICAgICBkYXRhOiBmb3JtRGF0YQogICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJGkxOG4udCgndGhlX3Bvc3Rfd2FzX3N1Y2Nlc3NmdWxseV9hZGRlZCcpCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5oYW5kbGVDbG9zZSgpCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kaTE4bi50KAogICAgICAgICAgICAgICd5b3VyX3JlcXVlc3RfaGFzX2VuY291bnRlcmVkX2FfcHJvYmxlbV9wbGVhc2VfdHJ5X2FnYWluJwogICAgICAgICAgICApCiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlQ2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2Nsb3NlLWRpYWxvZycpCiAgICAgIHRoaXMuJHJlZnNbJ2FkZFBvc3QnXS5yZXNldEZpZWxkcygpCiAgICB9LAogICAgaGFuZGxlR2V0Qm9va3MoKSB7CiAgICAgIHRoaXMuaGFuZGxlUmVxdWVzdCh7CiAgICAgICAgbmFtZTogJ2Jvb2tzL2xpc3QnLAogICAgICAgIGFjdGlvbjogJ2dldEFsbCcsCiAgICAgICAgZGF0YTogewogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgc29ydDogJ3JhdGU6ZGVzYycKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMuYm9va3MgPSByZXMuZGF0YS5ib29rcwogICAgICB9KQogICAgfSwKICAgIGhhbmRsZUNsb3NlQm9va0RpYWxvZygpIHsKICAgICAgdGhpcy5ib29rRGlhbG9nID0gZmFsc2UKICAgICAgdGhpcy5oYW5kbGVHZXRCb29rcygpCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBBZGRCb29rCiAgfQp9Cg=="},{"version":3,"sources":["Add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Add.vue","sourceRoot":"src/components/post","sourcesContent":["<template>\n  <div>\n    <el-dialog\n      :title=\"$t('add_post')\"\n      :visible.sync=\"dialogVisible\"\n      :close-on-click-modal=\"false\"\n      :close-on-escape=\"false\"\n      :show-close=\"false\"\n      width=\"40rem\"\n      top=\"7vh\"\n      class=\"small add-post\"\n    >\n      <el-form :model=\"addPostForm\" ref=\"addPost\" :rules=\"rules\">\n        <div class=\"flexbox wrap\">\n          <el-form-item :label=\"$t('post.book')\" prop=\"book\">\n            <el-select\n              v-model=\"addPostForm.book\"\n              filterable\n              default-first-option\n              :placeholder=\"$t('choose')\"\n            >\n              <el-option\n                v-for=\"item in books\"\n                :key=\"item.id\"\n                :label=\"item.name\"\n                :value=\"item.id\"\n              >\n              </el-option>\n            </el-select>\n            <el-button @click=\"bookDialog = true\">\n              {{ $t('add_book') }}\n            </el-button>\n          </el-form-item>\n        </div>\n        <el-form-item :label=\"$t('post.rate')\" prop=\"rate\">\n          <el-input-number\n            v-model=\"addPostForm.rate\"\n            :step=\"0.1\"\n            :min=\"0\"\n            :max=\"5\"\n          ></el-input-number>\n        </el-form-item>\n        <el-form-item :label=\"$t('post.text')\" prop=\"text\">\n          <el-input\n            type=\"textarea\"\n            class=\"rtl\"\n            resize=\"none\"\n            v-model=\"addPostForm.text\"\n            :rows=\"10\"\n          ></el-input>\n        </el-form-item>\n        <div class=\"text-center\">\n          <el-button\n            :loading=\"loading\"\n            class=\"ml-10\"\n            type=\"primary\"\n            @click=\"validateAndSubmitForm('addPost', addPost)\"\n          >\n            {{ $t('add') }}\n          </el-button>\n          <el-button @click=\"handleClose\"> {{ $t('close') }} </el-button>\n        </div>\n      </el-form>\n    </el-dialog>\n    <AddBook\n      :dialogVisible=\"bookDialog\"\n      @close-dialog=\"handleCloseBookDialog()\"\n    />\n  </div>\n</template>\n\n<script>\n  import AddBook from '@/components/book/Add'\n  import { mapGetters, mapActions } from 'vuex'\n\n  export default {\n    props: {\n      dialogVisible: {\n        type: Boolean,\n        default: false\n      }\n    },\n    data() {\n      return {\n        books: [],\n        loading: false,\n        bookDialog: false,\n        addPostForm: {\n          text: '',\n          rate: 0,\n          book: ''\n        },\n        rules: {\n          rate: [\n            {\n              required: true,\n              message: this.$i18n.t('field_required'),\n              trigger: 'blur'\n            }\n          ],\n          book: [\n            {\n              required: true,\n              message: this.$i18n.t('field_required')\n            }\n          ],\n          text: [\n            {\n              required: true,\n              message: this.$i18n.t('field_required'),\n              trigger: 'blur'\n            }\n          ]\n        }\n      }\n    },\n    created() {\n      this.handleGetBooks()\n    },\n    computed: {\n      ...mapGetters(['self'])\n    },\n    methods: {\n      ...mapActions(['handleRequest']),\n      addPost() {\n        this.loading = true\n        let formData = new FormData()\n        for (let [key, value] of Object.entries(this.addPostForm)) {\n          formData.append(key, value)\n        }\n        formData.append('user', this.self.id)\n\n        this.handleRequest({\n          name: 'posts/',\n          action: 'create',\n          data: formData\n        })\n          .then(() => {\n            this.$message({\n              type: 'success',\n              message: this.$i18n.t('the_post_was_successfully_added')\n            })\n            this.handleClose()\n            this.loading = false\n          })\n          .catch(() => {\n            this.loading = false\n            this.$message({\n              type: 'error',\n              message: this.$i18n.t(\n                'your_request_has_encountered_a_problem_please_try_again'\n              )\n            })\n          })\n      },\n      handleClose() {\n        this.$emit('close-dialog')\n        this.$refs['addPost'].resetFields()\n      },\n      handleGetBooks() {\n        this.handleRequest({\n          name: 'books/list',\n          action: 'getAll',\n          data: {\n            query: {\n              sort: 'rate:desc'\n            }\n          }\n        }).then((res) => {\n          this.books = res.data.books\n        })\n      },\n      handleCloseBookDialog() {\n        this.bookDialog = false\n        this.handleGetBooks()\n      }\n    },\n    components: {\n      AddBook\n    }\n  }\n</script>\n"]}]}