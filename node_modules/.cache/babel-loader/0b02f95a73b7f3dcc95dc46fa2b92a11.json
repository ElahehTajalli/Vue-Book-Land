{"remainingRequest":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/babel-loader/lib/index.js!/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/elaheh/Documents/University/Vue-Book-Land/src/components/chat/Messages.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/elaheh/Documents/University/Vue-Book-Land/src/components/chat/Messages.vue","mtime":1630222369391},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/Vue-Book-Land/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvZWxhaGVoL0RvY3VtZW50cy9Vbml2ZXJzaXR5L1Z1ZS1Cb29rLUxhbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNoYXRzOiBbXSwKICAgICAgdXNlcjoge30sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBtZXNzYWdlOiAnJywKICAgICAgdGltZXI6IDAKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbCh0aGlzLmdldERhdGEsIDEwMDApOwogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoWydzZWxmJ10pKSwKICBtZXRob2RzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcEFjdGlvbnMoWydoYW5kbGVSZXF1ZXN0J10pKSwge30sIHsKICAgIGdldERhdGE6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLmhhbmRsZVJlcXVlc3QoewogICAgICAgIG5hbWU6ICdjaGF0cycsCiAgICAgICAgYWN0aW9uOiAnZ2V0T25lJywKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBpZDogdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy5jaGF0cyA9IHJlcy5kYXRhLm1lc3NhZ2VzOwogICAgICAgIF90aGlzLnVzZXIgPSByZXMuZGF0YS51c2VyOwogICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdyZWNlaXZlcicsIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGV4dCcsIHRoaXMubWVzc2FnZSk7CiAgICAgIHRoaXMuaGFuZGxlUmVxdWVzdCh7CiAgICAgICAgbmFtZTogJ2NoYXRzLycsCiAgICAgICAgYWN0aW9uOiAnY3JlYXRlJywKICAgICAgICBkYXRhOiBmb3JtRGF0YQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczIuY2hhdHMucHVzaChyZXMpOwoKICAgICAgICBfdGhpczIubWVzc2FnZSA9ICcnOwogICAgICB9KTsKICAgIH0sCiAgICByb3V0ZVRvOiBmdW5jdGlvbiByb3V0ZVRvKCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ1ZpZXdVc2VyJywKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGlkOiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pLAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogIH0KfTs="},{"version":3,"sources":["Messages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA,SAAA,UAAA,EAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,IAAA,EAAA,EAFA;AAGA,MAAA,OAAA,EAAA,KAHA;AAIA,MAAA,OAAA,EAAA,EAJA;AAKA,MAAA,KAAA,EAAA;AALA,KAAA;AAOA,GATA;AAUA,EAAA,OAVA,qBAUA;AACA,SAAA,OAAA,GAAA,IAAA;AACA,SAAA,KAAA,GAAA,WAAA,CAAA,KAAA,OAAA,EAAA,IAAA,CAAA;AACA,GAbA;AAcA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,MAAA,CAAA,CADA,CAdA;AAiBA,EAAA,OAAA,kCACA,UAAA,CAAA,CAAA,eAAA,CAAA,CADA;AAEA,IAAA,OAFA,qBAEA;AAAA;;AACA,WAAA,aAAA,CAAA;AACA,QAAA,IAAA,EAAA,OADA;AAEA,QAAA,MAAA,EAAA,QAFA;AAGA,QAAA,IAAA,EAAA;AACA,UAAA,EAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA;AADA;AAHA,OAAA,EAOA,IAPA,CAOA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,KAAA,GAAA,GAAA,CAAA,IAAA,CAAA,QAAA;AACA,QAAA,KAAA,CAAA,IAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,OAVA,EAWA,OAXA,CAWA,YAAA;AACA,QAAA,KAAA,CAAA,OAAA,GAAA,KAAA;AACA,OAbA;AAcA,KAjBA;AAkBA,IAAA,WAlBA,yBAkBA;AAAA;;AACA,UAAA,QAAA,GAAA,IAAA,QAAA,EAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,UAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,MAAA,EAAA,KAAA,OAAA;AAEA,WAAA,aAAA,CAAA;AACA,QAAA,IAAA,EAAA,QADA;AAEA,QAAA,MAAA,EAAA,QAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OAAA,EAIA,IAJA,CAIA,UAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,KAAA,CAAA,IAAA,CAAA,GAAA;;AACA,QAAA,MAAA,CAAA,OAAA,GAAA,EAAA;AACA,OAPA;AAQA,KA/BA;AAgCA,IAAA,OAhCA,qBAgCA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA;AACA,QAAA,IAAA,EAAA,UADA;AAEA,QAAA,MAAA,EAAA;AAAA,UAAA,EAAA,EAAA,KAAA,MAAA,CAAA,MAAA,CAAA;AAAA;AAFA,OAAA;AAIA;AArCA,IAjBA;AAwDA,EAAA,aAxDA,2BAwDA;AACA,IAAA,aAAA,CAAA,KAAA,KAAA,CAAA;AACA;AA1DA,CAAA","sourcesContent":["<template>\n  <div class=\"messages\" v-loading.fullscreen.lock=\"loading\">\n    <el-card>\n      <div slot=\"header\" class=\"clearfix\">\n        <div>\n          <img\n            class=\"user-picture\"\n            v-if=\"user.image\"\n            :src=\"'http://ketabland.pythonanywhere.com' + user.image\"\n          />\n          <img\n            v-else\n            class=\"user-picture\"\n            src=\"https://img.icons8.com/cotton/64/000000/person-male--v2.png\"\n          />\n          <span class=\"bold-title\">{{ user.persian_username }}</span>\n        </div>\n        <el-button type=\"primary\" @click=\"routeTo()\">\n          {{ $t('show_profile') }}\n        </el-button>\n      </div>\n      <div class=\"main\">\n        <div class=\"chats\">\n          <span\n            v-for=\"c in chats\"\n            :key=\"c.id\"\n            :class=\"c.receiver.id === self.id ? 'receiver' : 'sender'\"\n          >\n            {{ c.text }}\n          </span>\n        </div>\n      </div>\n    </el-card>\n    <div class=\"bottom\">\n      <el-input v-model=\"message\" />\n      <el-button type=\"primary\" @click=\"sendMessage()\">\n        {{ $t('send') }}\n      </el-button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapGetters, mapActions } from 'vuex'\n\n  export default {\n    data() {\n      return {\n        chats: [],\n        user: {},\n        loading: false,\n        message: '',\n        timer: 0\n      }\n    },\n    created() {\n      this.loading = true\n      this.timer = setInterval(this.getData, 1000)\n    },\n    computed: {\n      ...mapGetters(['self'])\n    },\n    methods: {\n      ...mapActions(['handleRequest']),\n      getData() {\n        this.handleRequest({\n          name: 'chats',\n          action: 'getOne',\n          data: {\n            id: this.$route.params.id\n          }\n        })\n          .then((res) => {\n            this.chats = res.data.messages\n            this.user = res.data.user\n          })\n          .finally(() => {\n            this.loading = false\n          })\n      },\n      sendMessage() {\n        let formData = new FormData()\n        formData.append('receiver', this.$route.params.id)\n        formData.append('text', this.message)\n\n        this.handleRequest({\n          name: 'chats/',\n          action: 'create',\n          data: formData\n        }).then((res) => {\n          this.chats.push(res)\n          this.message = ''\n        })\n      },\n      routeTo() {\n        this.$router.push({\n          name: 'ViewUser',\n          params: { id: this.$route.params.id }\n        })\n      }\n    },\n    beforeDestroy() {\n      clearInterval(this.timer)\n    }\n  }\n</script>\n"],"sourceRoot":"src/components/chat"}]}