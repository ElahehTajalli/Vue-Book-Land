{"remainingRequest":"/home/elaheh/Documents/University/project/node_modules/babel-loader/lib/index.js!/home/elaheh/Documents/University/project/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/elaheh/Documents/University/project/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/elaheh/Documents/University/project/src/components/chat/Contacts.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/elaheh/Documents/University/project/src/components/chat/Contacts.vue","mtime":1628613987609},{"path":"/home/elaheh/Documents/University/project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/project/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/elaheh/Documents/University/project/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/elaheh/Documents/University/project/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvaG9tZS9lbGFoZWgvRG9jdW1lbnRzL1VuaXZlcnNpdHkvcHJvamVjdC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvaG9tZS9lbGFoZWgvRG9jdW1lbnRzL1VuaXZlcnNpdHkvcHJvamVjdC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb250YWN0czogW10sCiAgICAgIGxhc3RNZXNzYWdlczogW10sCiAgICAgIGNoYXRzOiBbXSwKICAgICAgaWRzOiBbXSwKICAgICAgdGltZXI6IDAsCiAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwodGhpcy5nZXREYXRhLCAxMDAwKTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsnc2VsZiddKSksCiAgbWV0aG9kczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBBY3Rpb25zKFsnaGFuZGxlUmVxdWVzdCddKSksIHt9LCB7CiAgICBnZXREYXRhOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5oYW5kbGVSZXF1ZXN0KHsKICAgICAgICBuYW1lOiAnY2hhdHMvJywKICAgICAgICBhY3Rpb246ICdnZXRBbGwnCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzLmNoYXRzID0gcmVzLmRhdGEubWVzc2FnZXM7CgogICAgICAgIF90aGlzLnNldENvbnRhY3RzKCk7CiAgICAgIH0pOwogICAgfSwKICAgIHNldENvbnRhY3RzOiBmdW5jdGlvbiBzZXRDb250YWN0cygpIHsKICAgICAgdGhpcy5jb250YWN0cyA9IFtdOwogICAgICB0aGlzLmxhc3RNZXNzYWdlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoYXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMuY2hhdHNbaV0uc2VuZGVyLmlkICE9PSB0aGlzLnNlbGYuaWQgJiYgdGhpcy5jb250YWN0cy5pbmRleE9mKHRoaXMuY2hhdHNbaV0uc2VuZGVyLnBlcnNpYW5fdXNlcm5hbWUpIDwgMCkgewogICAgICAgICAgdmFyIF90aGlzJGxhc3RNZXNzYWdlcyRwdTsKCiAgICAgICAgICB0aGlzLmNvbnRhY3RzLnB1c2godGhpcy5jaGF0c1tpXS5zZW5kZXIucGVyc2lhbl91c2VybmFtZSk7CiAgICAgICAgICB0aGlzLmxhc3RNZXNzYWdlcy5wdXNoKChfdGhpcyRsYXN0TWVzc2FnZXMkcHUgPSB7fSwgX2RlZmluZVByb3BlcnR5KF90aGlzJGxhc3RNZXNzYWdlcyRwdSwgdGhpcy5jaGF0c1tpXS5zZW5kZXIucGVyc2lhbl91c2VybmFtZSwgdGhpcy5jaGF0c1tpXS50ZXh0KSwgX2RlZmluZVByb3BlcnR5KF90aGlzJGxhc3RNZXNzYWdlcyRwdSwgInVzZXJfaWQiLCB0aGlzLmNoYXRzW2ldLnNlbmRlci5pZCksIF90aGlzJGxhc3RNZXNzYWdlcyRwdSkpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5jaGF0c1tpXS5yZWNlaXZlci5pZCAhPT0gdGhpcy5zZWxmLmlkICYmIHRoaXMuY29udGFjdHMuaW5kZXhPZih0aGlzLmNoYXRzW2ldLnJlY2VpdmVyLnBlcnNpYW5fdXNlcm5hbWUpIDwgMCkgewogICAgICAgICAgdmFyIF90aGlzJGxhc3RNZXNzYWdlcyRwdTI7CgogICAgICAgICAgdGhpcy5jb250YWN0cy5wdXNoKHRoaXMuY2hhdHNbaV0ucmVjZWl2ZXIucGVyc2lhbl91c2VybmFtZSk7CiAgICAgICAgICB0aGlzLmxhc3RNZXNzYWdlcy5wdXNoKChfdGhpcyRsYXN0TWVzc2FnZXMkcHUyID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfdGhpcyRsYXN0TWVzc2FnZXMkcHUyLCB0aGlzLmNoYXRzW2ldLnJlY2VpdmVyLnBlcnNpYW5fdXNlcm5hbWUsIHRoaXMuY2hhdHNbaV0udGV4dCksIF9kZWZpbmVQcm9wZXJ0eShfdGhpcyRsYXN0TWVzc2FnZXMkcHUyLCAidXNlcl9pZCIsIHRoaXMuY2hhdHNbaV0ucmVjZWl2ZXIuaWQpLCBfdGhpcyRsYXN0TWVzc2FnZXMkcHUyKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgIH0sCiAgICBzZXRSb3V0ZTogZnVuY3Rpb24gc2V0Um91dGUoaW5kZXgpIHsKICAgICAgaWYgKHRoaXMubGFzdE1lc3NhZ2VzW2luZGV4XVsndXNlcl9pZCddICE9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICdDaGF0SUQnLAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGlkOiB0aGlzLmxhc3RNZXNzYWdlc1tpbmRleF1bJ3VzZXJfaWQnXQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSksCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7CiAgfQp9Ow=="},{"version":3,"sources":["Contacts.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"contacts\" v-loading.fullscreen.lock=\"loading\">\n    <el-card>\n      <div slot=\"header\" class=\"clearfix\">\n        <span>{{ $t('contacts') }}</span>\n      </div>\n      <div class=\"items\">\n        <div\n          v-for=\"(c, index) in contacts\"\n          :key=\"c\"\n          class=\"item\"\n          @click=\"setRoute(index)\"\n        >\n          <span class=\"detail\">{{ c }}</span>\n          <span class=\"detail\">{{ lastMessages[index][c] }}</span>\n        </div>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\n  import { mapGetters, mapActions } from 'vuex'\n  export default {\n    data() {\n      return {\n        contacts: [],\n        lastMessages: [],\n        chats: [],\n        ids: [],\n        timer: 0,\n        loading: false\n      }\n    },\n    created() {\n      this.loading = true\n      this.timer = setInterval(this.getData, 1000)\n    },\n    computed: {\n      ...mapGetters(['self'])\n    },\n    methods: {\n      ...mapActions(['handleRequest']),\n      getData() {\n        this.handleRequest({\n          name: 'chats/',\n          action: 'getAll'\n        }).then((res) => {\n          this.chats = res.data.messages\n          this.setContacts()\n        })\n      },\n      setContacts() {\n        this.contacts = []\n        this.lastMessages = []\n        for (let i = 0; i < this.chats.length; i++) {\n          if (\n            this.chats[i].sender.id !== this.self.id &&\n            this.contacts.indexOf(this.chats[i].sender.persian_username) < 0\n          ) {\n            this.contacts.push(this.chats[i].sender.persian_username)\n            this.lastMessages.push({\n              [this.chats[i].sender.persian_username]: this.chats[i].text,\n              user_id: this.chats[i].sender.id\n            })\n          } else if (\n            this.chats[i].receiver.id !== this.self.id &&\n            this.contacts.indexOf(this.chats[i].receiver.persian_username) < 0\n          ) {\n            this.contacts.push(this.chats[i].receiver.persian_username)\n            this.lastMessages.push({\n              [this.chats[i].receiver.persian_username]: this.chats[i].text,\n              user_id: this.chats[i].receiver.id\n            })\n          }\n        }\n        this.loading = false\n      },\n      setRoute(index) {\n        if (this.lastMessages[index]['user_id'] != this.$route.params.id) {\n          this.$router.push({\n            name: 'ChatID',\n            params: { id: this.lastMessages[index]['user_id'] }\n          })\n        }\n      }\n    },\n    beforeDestroy() {\n      clearInterval(this.timer)\n    }\n  }\n</script>\n"],"sourceRoot":"src/components/chat"}]}